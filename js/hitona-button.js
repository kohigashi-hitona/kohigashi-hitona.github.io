const excel = [
    {
        "file_name": "6 (1)",
        "suffix": "mp3",
        "desCh": "介绍商品",
        "desJp": "商品説明",
        "titleCh": "好吃的~♪~♫",
        "titleJp": "美味しい~♪~♫"
    },
    {
        "file_name": 6,
        "suffix": "mp3",
        "desCh": "人鱼喜欢的口味",
        "desJp": "ひとなの好みの味付け",
        "titleCh": "好吃的~♪~♫",
        "titleJp": "美味しい~♪~♫"
    },
    {
        "file_name": "7 (1)",
        "suffix": "mp3",
        "desCh": "微波炉用法",
        "desJp": "レンジのチンし方",
        "titleCh": "好吃的~♪~♫",
        "titleJp": "美味しい~♪~♫"
    },
    {
        "file_name": "9 (2)",
        "suffix": "mp3",
        "desCh": "711原创小菜",
        "desJp": "セブンのオリジナルおかず",
        "titleCh": "好吃的~♪~♫",
        "titleJp": "美味しい~♪~♫"
    },
    {
        "file_name": 9,
        "suffix": "mp3",
        "desCh": "热完后...",
        "desJp": "熱した後...",
        "titleCh": "好吃的~♪~♫",
        "titleJp": "美味しい~♪~♫"
    },
    {
        "file_name": 8,
        "suffix": "mp3",
        "desCh": "一时的冲动",
        "desJp": "出来心で",
        "titleCh": "鱼憨憨",
        "titleJp": "おバカひとな"
    },
    {
        "file_name": "小东的阿巴阿巴",
        "suffix": "mp3",
        "desCh": "阿巴阿巴rui",
        "desJp": "ｱﾊﾞｱﾊﾞ",
        "titleCh": "非人类语言尝鲜",
        "titleJp": "非人類的言語試聴"
    },
    {
        "file_name": "我仿佛感觉小东在骂我",
        "suffix": "mp3",
        "desCh": "爸比~",
        "desJp": "ばび～",
        "titleCh": "非人类语言尝鲜",
        "titleJp": "非人類的言語試聴"
    },
    {
        "file_name": "无脑mp3",
        "suffix": "mp3",
        "desCh": "变湿循环",
        "desJp": "どんどん濡れてくリピート",
        "titleCh": "非人类语言尝鲜",
        "titleJp": "非人類的言語試聴"
    },
    {
        "file_name": "这又是啥",
        "suffix": "mp3",
        "desCh": "你个没骨气的家伙",
        "desJp": "意気地なしめ",
        "titleCh": "别骂了别骂了",
        "titleJp": "もっともっと"
    },
    {
        "file_name": "小东的阿巴阿巴1分洗脑 (1)",
        "suffix": "mp3",
        "desCh": "阿巴循环",
        "desJp": "ｱﾊﾞｱﾊﾞリピート",
        "titleCh": "非人类语言尝鲜",
        "titleJp": "非人類的言語試聴"
    },
    {
        "file_name": "死机鱼",
        "suffix": "mp3",
        "desCh": "死机鱼",
        "desJp": "ヒトナーダウン",
        "titleCh": "非人类语言尝鲜",
        "titleJp": "非人類的言語試聴"
    },
    {
        "file_name": 5,
        "suffix": "mp3",
        "desCh": "我开动了~",
        "desJp": "いただきま～す",
        "titleCh": "好吃的~♪~♫",
        "titleJp": "美味しい~♪~♫"
    },
    {
        "file_name": 7,
        "suffix": "mp3",
        "desCh": "晴琉琉喜欢的口味",
        "desJp": "ぱれるんの好みの味付け",
        "titleCh": "高举鱼丸大旗",
        "titleJp": "魚丸最高"
    },
    {
        "file_name": "8 (1)",
        "suffix": "mp3",
        "desCh": "嗯～这个真好吃",
        "desJp": "ん～うめーなこれな",
        "titleCh": "好吃的~♪~♫",
        "titleJp": "美味しい~♪~♫"
    },
    {
        "file_name": "这说啥呢",
        "suffix": "mp3",
        "desCh": "这里好恐怖好恐怖好恐怖",
        "desJp": "ここ怖み怖み怖み",
        "titleCh": "受惊鱼",
        "titleJp": "びっくりがし"
    },
    {
        "file_name": "呜哈哈",
        "suffix": "mp3",
        "desCh": "哇哈哈",
        "desJp": "わはは",
        "titleCh": "嚣东",
        "titleJp": "生意気ひとな"
    },
    {
        "file_name": "啊~新素材",
        "suffix": "mp3",
        "desCh": "啊~",
        "desJp": "あ～",
        "titleCh": "手冲必备（）",
        "titleJp": "手コキ用（）"
    },
    {
        "file_name": "这啥",
        "suffix": "mp3",
        "desCh": "哇变得越来越湿了怎么办啊",
        "desJp": "わどんどんみる濡れてるどうしよう",
        "titleCh": "非人类语言尝鲜",
        "titleJp": "非人類的言語試聴"
    },
    {
        "file_name": "推特录音",
        "suffix": "mp3",
        "desCh": "起床懒音",
        "desJp": "寝起き声",
        "titleCh": "ASMR",
        "titleJp": "ASMR"
    },
    {
        "file_name": "呜啊！啊↑哈↗哈↗",
        "suffix": "mp3",
        "desCh": "鱼叫",
        "desJp": "ひとな叫び",
        "titleCh": "耳膜测试",
        "titleJp": "鼓膜テスト"
    },
    {
        "file_name": "来听下说nm呢",
        "suffix": "mp3",
        "desCh": "在哪儿呢！啊↑出现了！",
        "desJp": "どこにいんねん！あ↑いたあ！",
        "titleCh": "耳膜测试",
        "titleJp": "鼓膜テスト"
    },
    {
        "file_name": "还是鱼吸叫",
        "suffix": "mp3",
        "desCh": "去哪了？呀！",
        "desJp": "どこにいた？キャッ！",
        "titleCh": "耳膜测试",
        "titleJp": "鼓膜テスト"
    },
    {
        "file_name": "鱼叫",
        "suffix": "mp3",
        "desCh": "注意耳膜",
        "desJp": "鼓膜注意",
        "titleCh": "耳膜测试",
        "titleJp": "鼓膜テスト"
    },
    {
        "file_name": "鱼叫2",
        "suffix": "mp3",
        "desCh": "出现啦！哈哈哈",
        "desJp": "いたあ！ははは",
        "titleCh": "耳膜测试",
        "titleJp": "鼓膜テスト"
    },
    {
        "file_name": "鱼吸叫",
        "suffix": "mp3",
        "desCh": "",
        "desJp": "",
        "titleCh": "耳膜测试",
        "titleJp": "鼓膜テスト"
    },
    {
        "file_name": "小东人鱼催尿音频",
        "suffix": "mp3",
        "desCh": "嘘~",
        "desJp": "",
        "titleCh": "神语气词",
        "titleJp": "神擬声語"
    },
    {
        "file_name": "小东人鱼催尿音频2",
        "suffix": "mp3",
        "desCh": "嘘↘",
        "desJp": "",
        "titleCh": "神语气词",
        "titleJp": "神擬声語"
    },
    {
        "file_name": 4,
        "suffix": "mp3",
        "desCh": "冲绳的七十一都卖些什么呀",
        "desJp": "何が置いてあるんだろう、沖縄のセブンって",
        "titleCh": "好吃的~♪~♫",
        "titleJp": "美味しい~♪~♫"
    },
    {
        "file_name": "小东的阿巴阿巴1分洗脑.pkf",
        "suffix": "",
        "desCh": "",
        "desJp": "",
        "titleCh": "",
        "titleJp": ""
    },
    {
        "file_name": "耳朵瞎了",
        "suffix": "mp3",
        "desCh": "道具大量掉落的问题",
        "desJp": "",
        "titleCh": "",
        "titleJp": ""
    },
    {
        "file_name": "这啥2",
        "suffix": "mp3",
        "desCh": "",
        "desJp": "",
        "titleCh": "",
        "titleJp": ""
    },
    {
        "file_name": "小东-あばべべべぶべぶ (320CBR)",
        "suffix": "mp3",
        "desCh": "",
        "desJp": "",
        "titleCh": "耳膜测试",
        "titleJp": "鼓膜テスト"
    },
    {
        "file_name": "小东-ありがとうございます！ (320CBR)",
        "suffix": "mp3",
        "desCh": "",
        "desJp": "ありがとうございます！",
        "titleCh": "日常用语",
        "titleJp": "日常用語"
    },
    {
        "file_name": "小东-えへへへへ (320CBR)",
        "suffix": "mp3",
        "desCh": "诶嘿嘿嘿嘿",
        "desJp": "えへへへへ",
        "titleCh": "手冲必备（）",
        "titleJp": "手コキ用（）"
    },
    {
        "file_name": "小东-きも... (320CBR)",
        "suffix": "mp3",
        "desCh": "恶心心",
        "desJp": "キモー",
        "titleCh": "别骂了别骂了",
        "titleJp": "もっともっと"
    },
    {
        "file_name": "小东-ごろごろー (320CBR)",
        "suffix": "mp3",
        "desCh": "咕噜咕噜",
        "desJp": "ゴロゴロ",
        "titleCh": "手冲必备（）",
        "titleJp": "手コキ用（）"
    },
    {
        "file_name": "小东-にゃー！ (320CBR)",
        "suffix": "mp3",
        "desCh": "喵~！",
        "desJp": "",
        "titleCh": "手冲必备（）",
        "titleJp": "手コキ用（）"
    },
    {
        "file_name": "小东-君は友達 (320CBR)",
        "suffix": "mp3",
        "desCh": "",
        "desJp": "君は友達",
        "titleCh": "手冲必备（）",
        "titleJp": "手コキ用（）"
    },
    {
        "file_name": "小东-哎呀妈呀 (320CBR)",
        "suffix": "mp3",
        "desCh": "哎呀妈呀",
        "desJp": "",
        "titleCh": "耳膜测试",
        "titleJp": "鼓膜テスト"
    },
    {
        "file_name": "小东-哒哒哒哒哒 (320CBR)",
        "suffix": "mp3",
        "desCh": "哒哒哒哒哒",
        "desJp": "ダダダダダ",
        "titleCh": "耳膜测试",
        "titleJp": "鼓膜テスト"
    },
    {
        "file_name": "小东-嘿嘿嘿 (320CBR)",
        "suffix": "mp3",
        "desCh": "嘿嘿嘿",
        "desJp": "へへへ",
        "titleCh": "鱼憨憨",
        "titleJp": "おバカひとな"
    },
    {
        "file_name": "小东-怪叫 (320CBR)",
        "suffix": "mp3",
        "desCh": "",
        "desJp": "",
        "titleCh": "耳膜测试",
        "titleJp": "鼓膜テスト"
    },
    {
        "file_name": "小东-我是嚣东 (320CBR)",
        "suffix": "mp3",
        "desCh": "我是嚣东",
        "desJp": "",
        "titleCh": "鱼憨憨",
        "titleJp": "おバカひとな"
    },
    {
        "file_name": "小东-我没打你我没打你的 (320CBR)",
        "suffix": "mp3",
        "desCh": "我没打你我没打你的",
        "desJp": "",
        "titleCh": "耳膜测试",
        "titleJp": "鼓膜テスト"
    },
    {
        "file_name": "小东-挨拶 (320CBR)",
        "suffix": "mp3",
        "desCh": "自我介绍（3岁）",
        "desJp": "自己紹介（3歳）",
        "titleCh": "鱼憨憨",
        "titleJp": "おバカひとな"
    },
    {
        "file_name": "小东-言う訳ないじゃん (320CBR)",
        "suffix": "mp3",
        "desCh": "",
        "desJp": "",
        "titleCh": "嚣东",
        "titleJp": "生意気ひとな"
    },
    {
        "file_name": "啊！！！",
        "suffix": "mp3",
        "desCh": "啊！！！",
        "desJp": "",
        "titleCh": "耳膜测试",
        "titleJp": "鼓膜テスト"
    },
    {
        "file_name": "啊啊啊啊（耳膜）",
        "suffix": "mp3",
        "desCh": "啊啊啊啊（耳膜）",
        "desJp": "",
        "titleCh": "耳膜测试",
        "titleJp": "鼓膜テスト"
    },
    {
        "file_name": "被变态追赶",
        "suffix": "mp3",
        "desCh": "被变态追赶",
        "desJp": "",
        "titleCh": "耳膜测试",
        "titleJp": "鼓膜テスト"
    },
    {
        "file_name": "好疼（鱼叫）",
        "suffix": "mp3",
        "desCh": "好疼（鱼叫）",
        "desJp": "",
        "titleCh": "耳膜测试",
        "titleJp": "鼓膜テスト"
    },
    {
        "file_name": "老痰音尖叫",
        "suffix": "mp3",
        "desCh": "老痰音尖叫",
        "desJp": "",
        "titleCh": "耳膜测试",
        "titleJp": "鼓膜テスト"
    },
    {
        "file_name": "我不做人了！（惊恐）",
        "suffix": "mp3",
        "desCh": "我不做人了！（惊恐）",
        "desJp": "",
        "titleCh": "耳膜测试",
        "titleJp": "鼓膜テスト"
    },
    {
        "file_name": "闸断xx惊叫",
        "suffix": "mp3",
        "desCh": "闸断xx惊叫",
        "desJp": "",
        "titleCh": "耳膜测试",
        "titleJp": "鼓膜テスト"
    },
    {
        "file_name": "好开心~",
        "suffix": "mp3",
        "desCh": "好开心~",
        "desJp": "",
        "titleCh": "人鱼说中文",
        "titleJp": "ひとなの中国語"
    },
    {
        "file_name": "你好狗",
        "suffix": "mp3",
        "desCh": "你好狗",
        "desJp": "",
        "titleCh": "人鱼说中文",
        "titleJp": "ひとなの中国語"
    },
    {
        "file_name": "你在说粤语？",
        "suffix": "mp3",
        "desCh": "你在说粤语？",
        "desJp": "",
        "titleCh": "人鱼说中文",
        "titleJp": "ひとなの中国語"
    },
    {
        "file_name": "碎~~水~~随~",
        "suffix": "mp3",
        "desCh": "碎~~水~~随~",
        "desJp": "",
        "titleCh": "人鱼说中文",
        "titleJp": "ひとなの中国語"
    },
    {
        "file_name": "委屈屈求关注",
        "suffix": "mp3",
        "desCh": "委屈屈求关注",
        "desJp": "",
        "titleCh": "人鱼说中文",
        "titleJp": "ひとなの中国語"
    },
    {
        "file_name": "mua~~~",
        "suffix": "mp3",
        "desCh": "mua~~~",
        "desJp": "",
        "titleCh": "神语气词",
        "titleJp": "神擬声語"
    },
    {
        "file_name": "prprpr muamuamua",
        "suffix": "mp3",
        "desCh": "prprpr muamuamua",
        "desJp": "",
        "titleCh": "神语气词",
        "titleJp": "神擬声語"
    },
    {
        "file_name": "句句句（蜜汁语气）",
        "suffix": "mp3",
        "desCh": "句句句（蜜汁语气）",
        "desJp": "",
        "titleCh": "神语气词",
        "titleJp": "神擬声語"
    },
    {
        "file_name": "啊！",
        "suffix": "mp3",
        "desCh": "啊！",
        "desJp": "",
        "titleCh": "受惊鱼",
        "titleJp": "びっくりがし"
    },
    {
        "file_name": "害怕到哼歌歌（背景磨刀）",
        "suffix": "mp3",
        "desCh": "害怕到哼歌歌（背景磨刀）",
        "desJp": "",
        "titleCh": "受惊鱼",
        "titleJp": "びっくりがし"
    },
    {
        "file_name": "磨刀杀鱼之惨叫",
        "suffix": "mp3",
        "desCh": "磨刀杀鱼之惨叫",
        "desJp": "",
        "titleCh": "受惊鱼",
        "titleJp": "びっくりがし"
    },
    {
        "file_name": "我不做人了！（惊恐）",
        "suffix": "mp3",
        "desCh": "我不做人了！（惊恐）",
        "desJp": "",
        "titleCh": "受惊鱼",
        "titleJp": "びっくりがし"
    },
    {
        "file_name": "这孩子真的被吓到了",
        "suffix": "mp3",
        "desCh": "这孩子真的被吓到了",
        "desJp": "",
        "titleCh": "受惊鱼",
        "titleJp": "びっくりがし"
    },
    {
        "file_name": "mu~~~~~~a",
        "suffix": "mp3",
        "desCh": "mu~~~~~~a",
        "desJp": "",
        "titleCh": "嚣东",
        "titleJp": "生意気ひとな"
    },
    {
        "file_name": "你又在瞧不起人鱼？",
        "suffix": "mp3",
        "desCh": "你又在瞧不起人鱼？",
        "desJp": "",
        "titleCh": "嚣东",
        "titleJp": "生意気ひとな"
    },
    {
        "file_name": "你在瞧不起我吗",
        "suffix": "mp3",
        "desCh": "你在瞧不起我吗",
        "desJp": "",
        "titleCh": "嚣东",
        "titleJp": "生意気ひとな"
    },
    {
        "file_name": "这是啥呀（鱼憨憨）",
        "suffix": "mp3",
        "desCh": "这是啥呀（鱼憨憨）",
        "desJp": "",
        "titleCh": "鱼憨憨",
        "titleJp": "おバカひとな"
    },
    {
        "file_name": "辣哭了",
        "suffix": "mp3",
        "desCh": "辣哭了",
        "desJp": "",
        "titleCh": "鱼哭了",
        "titleJp": "ひとなき"
    },
    {
        "file_name": "好辣好辣好辣",
        "suffix": "mp3",
        "desCh": "好辣好辣好辣",
        "desJp": "",
        "titleCh": "鱼之愤怒",
        "titleJp": "ひとなの怒り"
    },
    {
        "file_name": "嚣东 (320CBR)",
        "suffix": "mp3",
        "desCh": "明天上学上班的人 加油哦～",
        "desJp": "明日から学校お仕事の方 頑張ってね～",
        "titleCh": "嚣东",
        "titleJp": "生意気ひとな"
    }
]

const lan_map = {
    'cn': "Ch",
    'jp': 'Jp'
}

let button_items = [];

function play_hitona_audio(audio_id) {
    $('#player').attr('src', button_items[audio_id][0]);
    document.getElementById('player').play();
}

function show_hitona_button() {
    $('#p-content').load('hitona-button.html', function() {
        let suffix = 'Jp';
        if(lan_map[lan_my_lan] !== undefined) {
            suffix = lan_map[lan_my_lan];
        }
        button_items = [];
        const desKey = 'des' + suffix, titleKey = 'title' + suffix;
        let category = {};
        //Category the item.
        for(let i=0; i<excel.length; ++i) {
            const item_title = excel[i][titleKey];
            if(item_title.length === 0 || excel[i][desKey].length === 0) {
                continue;
            }
            if(category[item_title] === undefined) {
                category[item_title] = Object.keys(category).length;
            }
            button_items.push([
                '/asserts/voices/' + excel[i]['file_name'] + '.' + excel[i]['suffix'],//Url
                excel[i][desKey], //Label
                category[item_title]//Category
            ]);
        }
        let heads = [];
        const head_title = Object.keys(category);
        for(let i=0; i<head_title.length; ++i) {
            heads.push([category[head_title[i]], head_title[i]]);
        }
        heads.sort(function(a, b) { return a[0] - b[0]; });
        //Generate the soruce code.
        let item_html = [];
        for(let i=0; i<heads.length; ++i) {
            const id = heads[i][0];
            item_html.push('<div><h2>'+heads[i][1]+'</h2><ul class="voice-items">');
            for(let j=0; j<button_items.length; ++j) {
                if(button_items[j][2] === id) {
                    const button_src = [
                        '<li><div class="kohigashi-button" id="button-'+j+'" onclick="play_hitona_audio('+j+');"><span>',
                        button_items[j][1],
                        '</span></div></li>'
                    ];
                    item_html.push(button_src.join('\n'));
                }
            }
            item_html.push('</ul></div>');
        }
        $('#voice-buttons').html(item_html.join('\n'));
    });
}